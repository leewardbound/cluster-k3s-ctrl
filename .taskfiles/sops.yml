---
version: "3"

tasks:
  unlock:
    desc: Decrypt the sops files
    cmds:
      - grep -rlw cluster/**/*.sops.yaml -e '^sops:' | grep {{.FN}} | xargs -rt -n1 sops --decrypt --in-place
    vars:
      FN: "."

  lock:
    desc: Encrypt the sops files
    cmds:
      - grep -rLw cluster/**/*.sops.yaml -e '^sops:' | grep {{.FN}} | xargs -rt -n1 sops --encrypt --in-place
    vars:
      FN: "."
